"use strict";(self.webpackChunkfront_end=self.webpackChunkfront_end||[]).push([[851],{4851:(t,n,e)=>{e.r(n),e.d(n,{default:()=>D});var o=e(9896),a=e(9419),s=e(9349),r=e(6036),c=e(228),d=e.n(c),i=e(5936),l=e.n(i),p=e(5043);const g=e.p+"static/media/holding.a9f895f6127d2d8f703a7a91b464f56c.svg";const u=e.p+"static/media/showground.8d58ce9f7f17a7f61aad975c0747eb64.svg";const m=e.p+"static/media/market.cd9cb3f068fd2d9aab513c4b36ad916d.svg";const v=e.p+"static/media/slaughterhouse.5eda9a7d69fbd0ab1e007c1a7460e90b.svg";var b=e(8495),f=(e(8856),e(1628)),h=e(1398),y=e(1763),x=(e(3378),e(8814)),k=e(9837),j=e(900),S=e(2242),w=(e(6433),e(579));const C=p.memo((t=>{let{jsonData:n,secondJsonData:e,checkedLayers:i,useCountyandHotspotLayers:C,setOpenSideBar:D,openSideBar:L}=t;const M=(0,p.useRef)(),O=n.move?Object.values(n.move):[],F=O.map((t=>[t.lat,t.lon])),R=e.move?Object.values(e.move):[],z=R.map((t=>[t.lat,t.lon])),B={holding:new c.Icon({iconUrl:g,iconSize:[40,40],iconAnchor:[20,35]}),showground:new c.Icon({iconUrl:u,iconSize:[40,40],iconAnchor:[20,35]}),market:new c.Icon({iconUrl:m,iconSize:[40,40],iconAnchor:[20,35]}),slaughterhouse:new c.Icon({iconUrl:v,iconSize:[40,40],iconAnchor:[20,35]})},I=t=>{let n=t.type;return"Agricultural Holding"===n?B.holding:"Market"===n?B.market:"Slaughterhouse (Red Meat)"===n?B.slaughterhouse:"Showground"===n?B.showground:B.holding},T=t=>new c.divIcon({html:'<span class="cluster-icon">'.concat(t.getChildCount(),"</span>"),className:"cluster-icon",iconSize:[30,30]}),H=function(t,n,e,o){return'\n    <div class="fs-5 fw-bold">'.concat(t.identifier,'</div><br>\n    <div>\n      <nav>\n        <div class="nav nav-tabs" id="popupNav" role="tablist">\n          <button class="nav-link active" id="navSummary" data-bs-toggle="tab" data-bs-target="#navSummaryContent').concat(e).concat(o,'" type="button" role="tab" aria-controls="navSummaryContent" aria-selected="true">Summary</button>\n          <button class="nav-link" id="navInfo" data-bs-toggle="tab" data-bs-target="#navInfoContent').concat(e).concat(o,'" type="button" role="tab" aria-controls="navInfoContent" aria-selected="false">Animal</button>\n        </div>\n      </nav>\n      <div class="tab-content" id="popTabContent">     \n        <div class="tab-pane fade show active" id="navSummaryContent').concat(e).concat(o,'" role="tabpanel" aria-labelledby="navSummary" tabindex="0">\n          <table class="table table-striped">\n            <tbody>\n              <tr>\n                <td><strong>Movement:</strong></td>\n                <td>',"".concat(e+1," of ").concat(n.length),"</td>\n              </tr>\n              <tr>\n                <td><strong>Duration of Stay:</strong></td>\n                <td>").concat(n[e].stay_length<=30?"".concat(n[e].stay_length," days"):n[e].stay_length>30&&n[e].stay_length<=365?"".concat((n[e].stay_length/7).toFixed(0)," weeks"):"".concat((n[e].stay_length/365).toFixed(1)," years"),"\n                </td> \n              </tr>\n              <tr>\n                <td><strong>Date of Arrival:</strong></td>\n                <td>").concat(n[e].on_date,"</td> \n              </tr>\n              <tr>\n                <td><strong>Date of Departure:</strong></td>\n                <td>").concat(n[e].off_date,"</td> \n              </tr>\n              <tr>\n                <td><strong>Species:</strong></td>\n                <td>").concat("COW"===t.species?"Bovine":t.species,"</td>\n              </tr>\n              <tr>\n                <td><strong>Precise Location:</strong></td>\n                <td>").concat(n[e].cph,"</td>\n              </tr>\n              <tr>\n                <td><strong>Precise Location Type:</strong></td>\n                <td>").concat(n[e].type,"</td>\n              </tr>\n              <tr>\n                <td><strong>OS Map Reference:</strong></td>\n                <td>").concat(n[e].os_map_ref,"</td>\n              </tr>\n              <tr>\n                <td><strong>Submission:</strong></td>\n                <td>").concat(t.submission,"</td> \n              </tr>\n              <tr>\n                <td><strong>County:</strong></td>\n                <td>").concat(n[e].county,"</td>\n              </tr>\n              <tr>\n                <td><strong>Clade:</strong></td>\n                <td>").concat(t.clade,"</td>\n              </tr>\n              <tr>\n                <td><strong>Out of Home Range:</strong></td>\n                <td>").concat("N"===t.out_of_homerange?"No":"Yes","</td>\n              </tr>\n              <tr>\n                <td><strong>Risk Area:</strong></td>\n                <td>").concat(n[e].risk_area_current,'</td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n        <div class="tab-pane fade show" id="navInfoContent').concat(e).concat(o,'" role="tabpanel" aria-labelledby="navInfo" tabindex="0">\n          <table class="table table-striped">\n            <tbody>\n              <tr>\n                <td><strong>Birth Location:</strong></td>\n                <td>').concat(n[0].cph,"</td>\n              </tr>\n              <tr>\n                <td><strong>Date of Birth:</strong></td>\n                <td>").concat(t.dob,"</td>\n              </tr>\n              <tr>\n                <td><strong>Slaughter Date:</strong></td>\n                <td>").concat(t.slaughter_date,"</td>\n              </tr>\n              <tr>\n                <td><strong>Sex:</strong></td>\n                <td>").concat("F"==t.sex?"Female":"M"==t.sex?"Male":"Unknown","</td>\n              </tr> \n              <tr>\n                <td><strong>Disclosing Test Type:</strong></td>\n                <td>").concat(t.disclosing_test,"</td>\n              </tr> \n              <tr>\n                <td><strong>Import Country:</strong></td>\n                <td>").concat(null==t.import_country?"British":"".concat(t.import_country),"</td>\n              </tr> \n            </tbody>\n          </table>\n        </div>\n      </div>           \n    ")},U={maxWidth:400,className:"cattlePopup",autoClose:!1,closeOnClick:!1},N=()=>{const t=(0,o.ko)();(0,p.useEffect)((()=>{const n=d().control({position:"topright"});return n.onAdd=()=>{const t=d().DomUtil.create("div","leaflet-control leaflet-bar");return t.insertAdjacentHTML("afterbegin",'<div class="icons-legend"> <span class="fs-6" style="padding-left:6px;"><strong>Legend</strong></span>\n            <span style="display: flex; align-items: center;">\n            <img src='.concat(g,' class="legend-marker-img">\n            <span>Holding</span>\n          </span>\n          <span style="display: flex; align-items: center;">\n          <img src=').concat(m,' class="legend-marker-img">\n          <span>Market</span>\n        </span>\n        <span style="display: flex; align-items: center;">\n        <img src=').concat(u,' class="legend-marker-img">\n        <span>Showground</span>\n        </span>\n        <span style="display: flex; align-items: center;">\n      <img src=').concat(v,' class="legend-marker-img">\n      <span>Slaughterhouse</span>\n      </span>\n      <span style="display: flex; align-items: center;">\n      <img src=').concat(b.A,' class="legend-marker-img">\n      <span>Movement cluster</span>\n      </span>\n      <span style="display: flex; align-items: center;">\n      <svg style="margin-left: 5px;" xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="#0096FF" class="bi bi-caret-right-fill" viewBox="0 0 16 16">\n        <path d="m12.14 8.753-5.482 4.796c-.646.566-1.658.106-1.658-.753V3.204a1 1 0 0 1 1.659-.753l5.48 4.796a1 1 0 0 1 0 1.506z"/>\n      </svg>\n      <span  style="padding-left:10px;">Cattle movement lines</span>\n    </span>\n          </div>')),t},n.addTo(t),()=>{t.removeControl(n)}}))},P=t=>[{repeat:100,symbol:d().Symbol.arrowHead({pixelSize:15,polygon:!0,pathOptions:{stroke:!0,color:t}})}],E=P("#0096FF"),J=P("#cb181d"),W=t=>{let{patterns:n,color:e,position:a}=t;const s=(0,o.ko)(),r=(0,p.useRef)(null),c=(0,p.useRef)([]);(0,p.useEffect)((()=>{if(!s)return;const t=d().polyline(a,{color:e}).addTo(s),o=d().polylineDecorator(t,{patterns:n}).addTo(s);return r.current=t,c.current=o,()=>{r.current&&(s.removeLayer(r.current),s.removeLayer(c.current))}}))};return(0,w.jsx)("div",{ref:M,children:(0,w.jsxs)(a.W,{center:[53.3781,-1],zoom:6,children:[(0,w.jsx)(s.e,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,w.jsx)(A,{mapRef:M}),(0,w.jsx)(y.A,{isChecked:C.hotspotLayers}),(0,w.jsx)(h.A,{isChecked:C.countyLayers}),Object.keys(i).length>0&&(0,w.jsx)(f.A,{checkedLayers:i}),(0,w.jsx)(S.A,{}),(0,w.jsx)(_,{jsonData:n,secondJsonData:e}),(0,w.jsx)(j.A,{}),(0,w.jsx)(x.A,{setOpenSideBar:D,openSideBar:L,type:"movement"}),(0,w.jsx)(k.A,{}),F.concat(z).length>0&&(0,w.jsx)(N,{}),(0,w.jsx)(l(),{chunkedLoading:!0,iconCreateFunction:T,maxClusterRadius:0,children:F.map(((t,e)=>(0,w.jsx)(r.p,{ref:t=>null===t||void 0===t?void 0:t.bindPopup(H(n,O,e,"firstMov-".concat(e)),U),position:t,icon:I(O[e]),children:(0,w.jsx)(W,{patterns:E,color:"#0096FF",position:F},"decorator-".concat(e))},"firstMov-".concat(e))))}),(0,w.jsx)(l(),{chunkedLoading:!0,iconCreateFunction:T,maxClusterRadius:0,children:z.map(((t,n)=>(0,w.jsx)(r.p,{ref:t=>null===t||void 0===t?void 0:t.bindPopup(H(e,R,n,"secondMov-".concat(n)),U),position:t,icon:I(R[n]),children:(0,w.jsx)(W,{patterns:J,color:"#cb181d",position:z},"second-decorator-".concat(n))},"secondMov-".concat(n))))})]})})})),_=t=>{let{jsonData:n,secondJsonData:e}=t;const a=(0,o.ko)(),s=[...n.move?Object.values(n.move).map((t=>[t.lat,t.lon])):[],...e.move?Object.values(e.move).map((t=>[t.lat,t.lon])):[]];return(0,p.useEffect)((()=>{s.length>0&&a.fitBounds(d().latLngBounds(s).pad(.1))}),[n,e]),(0,w.jsx)(w.Fragment,{})},A=t=>{let{mapRef:n}=t;const e=(0,o.ko)(),a=new ResizeObserver((()=>{e&&n.current&&e.invalidateSize()}));(0,p.useEffect)((()=>(n.current&&a.observe(n.current),()=>{a.disconnect()})),[])},D=C}}]);
//# sourceMappingURL=851.6c55cbb5.chunk.js.map