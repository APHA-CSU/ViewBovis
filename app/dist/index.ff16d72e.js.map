{"mappings":"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","sources":["src/js/cattle_movement_map.js"],"sourcesContent":["// =========================================== //\r\n// Cattle Movement Leaflet Map\r\n//\r\n// Code: JavaScript\r\n// Author: Tom Jenkins (Tom.Jenkins@apha.gov.uk)\r\n// =========================================== //\r\n\r\n\"use strict\";\r\n\r\n\r\n// ------------------------ //\r\n//\r\n// DUMMY DATA (TESTING ONLY)\r\n//\r\n// ------------------------ //\r\n\r\n// DUMMY DATA #1\r\n// const mov1 = [\r\n//   [52.478146, 0.796967, \"Farm1\"],\r\n//   [52.452912, 1.123962, \"Farm2\"],\r\n//   [52.749631, 0.887175, \"CPH1\"],\r\n//   [52.832337, 1.144929, \"CPH2\"],\r\n//   [52.760774, 1.36849, \"Slaughterhouse\"]\r\n// ];\r\n\r\n// DUMMY DATA #2\r\n// Structure corresponds to MDWH format: shorturl.at/ftIN0\r\nconst mov1 = [\r\n  [51.81296, -1.738453, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/01\", \"Farm\", \"Norfolk\", \"LRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.32055, -1.871136, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/02\", \"Farm\", \"Norfolk\", \"LRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [51.84591, -2.314109, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/03\", \"Farm\", \"Norfolk\", \"LRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.89763, -1.719953, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/04\", \"Farm\", \"Norfolk\", \"LRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.9762, -1.038638, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/05\", \"Farm\", \"Norfolk\", \"LRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\"],\r\n  [52.86099, -0.8604088, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/06\", \"Farm\", \"Norfolk\", \"HRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.54504, -1.982333, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/07\", \"Farm\", \"Norfolk\", \"HRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.42978, -1.132525, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/08\", \"Farm\", \"Norfolk\", \"HRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.93212, -0.930516, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/09\", \"Farm\", \"Norfolk\", \"HRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n  [52.70011, -2.2853, \"AF-12-00001-22\", \"B1-11\", \"UK000000000001\", \"Bovine\", \"2022-01-01\", \"12/345/67/10\", \"Slaughterhouse\", \"Norfolk\", \"HRA\", \"B2-11\", \"Yes\", \"North Devon\", \"2014-01-03\", \"Female\"],\r\n];\r\n\r\n\r\n// ------------------------ //\r\n//\r\n// BASEMAP PARAMETERS\r\n//\r\n// ------------------------ //\r\n\r\n// Coordinates and zoom level of map on first render\r\nconst defaultCoords = [52.56555275762325, -1.4667093894864072];\r\nconst defaultZoom = 6;\r\n\r\n// Tiles\r\n// https://leaflet-extras.github.io/leaflet-providers/preview/\r\n\r\n// OpenStreetMap tiles\r\nconst osm = L.tileLayer(\"https://tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n    maxZoom: 19,\r\n    attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\r\n});\r\n// Esri grey canvas\r\nconst Esri_WorldGrayCanvas = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {\r\n\tattribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',\r\n\tmaxZoom: 16,\r\n});\r\n// Esri world imagery\r\nconst Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {\r\n\tattribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'\r\n});\r\n\r\n// Initiate map and set bounding box to the centre of England\r\n// const map = L.map(\"map\").setView(defaultCoords, defaultZoom);\r\nconst map = L.map(\"map\", {\r\n  center: defaultCoords,\r\n  zoom: defaultZoom,\r\n  layers: [osm, Esri_WorldGrayCanvas, Esri_WorldImagery]\r\n});\r\n\r\n\r\n// ------------------------ //\r\n//\r\n//  ADDITIONAL MAP FEATURES\r\n//\r\n// ------------------------ //\r\n\r\n// TODO\r\n// Reset view to default coordinates and zoom on click of button\r\n\r\n// Add a measurement tool to the map\r\n// Leaflet plugin: https://github.com/NLTGit/Leaflet.LinearMeasurement\r\nmap.addControl(\r\n  new L.Control.LinearMeasurement({\r\n    unitSystem: \"imperial\",\r\n    position: \"topleft\",\r\n    color: \"#FF0080\",\r\n    type: \"line\",\r\n  })\r\n);\r\n\r\n// Add a control layer for basemaps in the top-right to allow user to change the basemap tiles\r\nconst baseMaps = {\r\n  \"Open Street Map\": osm,\r\n  \"Esri Grey Canvas\": Esri_WorldGrayCanvas,\r\n  \"Esri World Imagery\": Esri_WorldImagery,\r\n};\r\nlet layerControl = L.control.layers(baseMaps, null, {collapsed: false}).addTo(map);\r\n// Add a title to the basemap control\r\ndocument.querySelector(\".leaflet-control-layers-base\").insertAdjacentHTML(\"beforebegin\", \"<strong style='font-size: 15px; margin-bottom: 15px;'>Basemaps</strong>\");\r\ndocument.querySelector('.leaflet-control-layers-selector').click() // ensure OSM is the default basemap\r\n\r\n// TODO\r\n// Add scalebar to the map\r\nL.control.scale({imperial: false}).addTo(map);\r\n\r\n// TODO (MAYBE)\r\n// Function that creates a popup to user (lat-lon coordinates) upon clicking on the map\r\n// https://leafletjs.com/examples/quick-start/\r\n// var popup = L.popup();\r\n// function onMapClick(e) {\r\n//     popup\r\n//         .setLatLng(e.latlng)\r\n//         .setContent(\"You clicked the map at \" + e.latlng.toString())\r\n//         .openOn(map);\r\n// }\r\n// map.on('click', onMapClick);\r\n\r\n\r\n// ------------------------ //\r\n//\r\n// TOGGLE SIDEBAR LAYERS\r\n//\r\n// ------------------------ //\r\n\r\n// Initiate variables to store shapefile data\r\nlet countyPoly, riskAreaPoly, homeRangePoly;\r\n\r\n// Function to toggle layers on or off\r\nconst toggleLayers = function(layer){\r\n\r\n  // When checkbox is ticked, add layer to map\r\n  if(this.checked === true){\r\n    layer.addTo(map) \r\n  };\r\n\r\n  // When checkbox is unticked, remove layer from map\r\n  if(this.checked === false) map.removeLayer(layer);\r\n};\r\n\r\n// Leaflet plugin URL for adding shapefiles\r\n// https://github.com/calvinmetcalf/leaflet.shapefile\r\n\r\n// Function to highlight borders of each polygon on mouseover (when mouse hovers over them)\r\nconst highlightFeature = function(e) {\r\n  const layer = e.target;\r\n\r\n  layer.setStyle({\r\n    weight: 3,\r\n    color: \"#252525\",\r\n  });\r\n\r\n  layer.bringToFront();\r\n};\r\n\r\n// Function to reset border to original style on mouseout (when mouse is not hovering over a polygon)\r\nconst resetHighlight = function(e) {\r\n  countyPoly.resetStyle(e.target);\r\n  console.log(e.target);\r\n};\r\n\r\n// Function to zoom to a polygon when it is clicked\r\nconst zoomToPoly = function(e) {\r\n  map.fitBounds(e.target.getBounds());\r\n};\r\n\r\n// Function to add highlighting parameters to a layer\r\nconst onEachFeature = function(feature, layer) {\r\n  layer.on({\r\n    mouseover: highlightFeature,\r\n    mouseout: resetHighlight,\r\n    click: zoomToPoly,\r\n  });\r\n};\r\n\r\n// Function to set a range of polygon colours for Risk Areas\r\nconst riskAreaCols = function(area) {\r\n  switch (area) {\r\n    case \"High Risk Area\": return \"#C62828\";\r\n    case \"High TB Area\": return \"#C62828\";\r\n    case \"Intermediate TB Area\": return \"orange\";\r\n    case \"Edge Area\": return \"orange\";\r\n    case \"Low Risk Area\" : return \"#00C853\";\r\n    case \"Low TB Area\": return \"#00C853\";\r\n    case \"TB Free Area\": return \"#CFD8DC\";\r\n  };\r\n};\r\n\r\n// Function to set custom styles for Risk Area polygons\r\nconst styleRiskAreaPoly = function(feature){\r\n    return {\r\n      fillColor: riskAreaCols(feature.properties.TB_Area),\r\n      weight: 1.5,  \r\n      opacity: 1,\r\n      color: \"white\",\r\n      dashArray: \"3\",\r\n      fillOpacity: 0.50,\r\n  };\r\n};\r\n\r\n// Function to set custom styles for other polygons\r\nconst stylePoly = function(color = \"blue\"){\r\n    return {\r\n      fillColor: color,\r\n      weight: 1.5,  \r\n      opacity: 1,\r\n      color: \"white\",\r\n      dashArray: \"3\",\r\n      fillOpacity: 0.50,\r\n  };\r\n};\r\n\r\n// Toggle county polygons when checkbox is ticked or unticked\r\ncountyPoly = new L.Shapefile(\"../data/AHVLACounties20120315.zip\", {style: stylePoly(\"royalblue\"), onEachFeature: onEachFeature});\r\nconst countyBox = document.getElementById(\"countyBox\"); // select element from DOM\r\ncountyBox.addEventListener(\"change\", toggleLayers.bind(countyBox, countyPoly)); // event listener on the county checkbox\r\n\r\n// Toggle risk area polygons when checkbox is ticked or unticked\r\nriskAreaPoly = new L.Shapefile(\"../data/RiskAreas.zip\", {style: styleRiskAreaPoly});\r\nconst riskAreaBox = document.getElementById(\"riskAreasBox\");\r\nriskAreaBox.addEventListener(\"change\", toggleLayers.bind(riskAreaBox, riskAreaPoly));\r\n\r\n// Toggle risk area polygons when checkbox is ticked or unticked\r\nhomeRangePoly = new L.Shapefile(\"../data/HR2021.zip\", stylePoly(\"purple\"));\r\nconst homeRangeBox = document.getElementById(\"homeRangesBox\");\r\nhomeRangeBox.addEventListener(\"change\", toggleLayers.bind(homeRangeBox, homeRangePoly));\r\n\r\n// Legend for Risk Areas\r\n// https://leafletjs.com/examples/choropleth/\r\n// TODO\r\nlet legend = L.control({position: \"bottomright\"});\r\nlegend.onAdd = function (map) {\r\n\r\n    let div = L.DomUtil.create('div', 'info legend');\r\n    const levels = [\"High Risk Area\", \"Edge Area\", \"Low Risk Area\", \"High TB Area\", \"Intermediate TB Area\", \"Low TB Area\", \"TB Free Area\"];\r\n    const colours = [\"#C62828\", \"orange\", \"#00C853\", \"#C62828\", \"orange\",\"#00C853\", \"#CFD8DC\"];\r\n    const country = [\"ENG\", \"ENG\", \"ENG\", \"WAL\", \"WAL\", \"WAL\", \"SCO\"];\r\n\r\n    // Build legend: loop through levels and generate a label with a colored square\r\n\r\n    // England\r\n    div.insertAdjacentHTML(\"afterbegin\", \"<strong>England</strong><br>\");\r\n    for (let i = 0; i < levels.length; i++) \r\n      if (country[i] === \"ENG\") div.insertAdjacentHTML(\"beforeend\", `<i style=\"background: ${colours[i]};\"></i> ${levels[i]} <br>`);\r\n    \r\n    div.insertAdjacentHTML(\"beforeend\", \"<br>\");\r\n\r\n    // Wales\r\n    div.insertAdjacentHTML(\"beforeend\", \"<strong>Wales</strong><br>\");\r\n    for (let i = 0; i < levels.length; i++) \r\n      if (country[i] === \"WAL\") div.insertAdjacentHTML(\"beforeend\", `<i style=\"background: ${colours[i]};\"></i> ${levels[i]} <br>`);\r\n\r\n    div.insertAdjacentHTML(\"beforeend\", \"<br>\");\r\n\r\n    // Scotland\r\n    div.insertAdjacentHTML(\"beforeend\", \"<strong>Scotland</strong><br>\");\r\n    for (let i = 0; i < levels.length; i++) \r\n      if (country[i] === \"SCO\") div.insertAdjacentHTML(\"beforeend\", `<i style=\"background: ${colours[i]};\"></i> ${levels[i]} <br>`);\r\n\r\n    return div;\r\n};\r\n\r\n// Toggle legend when checkbox is (un)ticked\r\nriskAreaBox.addEventListener(\"change\", function() {\r\n\r\n    // When checkbox is ticked\r\n    if(this.checked === true) legend.addTo(map);\r\n  \r\n    // When checkbox is unticked\r\n    if(this.checked === false) legend.remove();\r\n});\r\n\r\n\r\n// ------------------------ //\r\n//\r\n// MAIN SCRIPT FUNCTIONALITY\r\n//\r\n// ------------------------ //\r\n\r\n// Cow icons\r\nconst cowIcon = L.icon({\r\n    iconUrl: \"../images/Cow_GIS_Team.svg\",\r\n    // iconUrl: \"file:///C:/Users/m1004795/OneDrive%20-%20Defra/bTB/ViewBovis/ViewBovis%20Design%20A/images/Cow_GIS_Team.svg\",\r\n    iconSize: [50, 50],\r\n    iconAnchor: [25, 35], // horizontal and vertical adjustment so that the cow head exactly matches marker coordinate\r\n});\r\n\r\n// Initiate variables to store spatial data for cow markers and cattle movement lines\r\nlet cowMarker, cattleMovLine;\r\n\r\n// Custom popup options\r\n// https://leafletjs.com/reference.html#popup\r\nconst customOptions = {\r\n    maxWidth: 400, // in pixels\r\n    className: \"popupCustom\" // must match a css class in styles.css\r\n};\r\n\r\n// Show cattle movement content on click of 'Show Movements' button\r\ndocument.getElementById(\"btn_show-movements\").addEventListener(\"click\", function(){\r\n    \r\n    // Add all cattle movement points to the map\r\n    for (let i = 0; i < mov1.length; i++){\r\n      cowMarker = new L.marker([mov1[i][0], mov1[i][1]], {icon: cowIcon}); // leaflet marker object to store coordinates\r\n\r\n      // Store data for each movement point in an array\r\n      const movData = mov1[i].slice(2, i.length); // extract data from third to last element in array (first two elements are lat and lon)\r\n\r\n      // Create HTML popup content using template literal\r\n      // The first number in movData[x-x] corresponds to the column number in the MDWH csv file (subtracting 1 as JS indexing starts at 0)\r\n      const popupContent = `\r\n      <div class=\"fs-5 fw-bold\">${movData[2]}</div><br>\r\n      <div>\r\n        <nav>\r\n          <div class=\"nav nav-tabs\" id=\"popupNav\" role=\"tablist\">\r\n            <button class=\"nav-link active\" id=\"navSummary\" data-bs-toggle=\"tab\" data-bs-target=\"#navSummaryContent\" type=\"button\" role=\"tab\" aria-controls=\"navSummaryContent\" aria-selected=\"true\">Summary</button>\r\n            <button class=\"nav-link\" id=\"navInfo\" data-bs-toggle=\"tab\" data-bs-target=\"#navInfoContent\" type=\"button\" role=\"tab\" aria-controls=\"navInfoContent\" aria-selected=\"false\">Animal</button>\r\n          </div>\r\n        </nav>\r\n        <div class=\"tab-content\" id=\"popTabContent\">     \r\n          <div class=\"tab-pane fade show active\" id=\"navSummaryContent\" role=\"tabpanel\" aria-labelledby=\"navSummary\" tabindex=\"0\">\r\n            <table class=\"table table-striped\">\r\n              <tbody>\r\n                <tr>\r\n                  <td><strong>Movement:</strong></td>\r\n                  <td>${i+1} ${i===0 ? \"(Origin)\" : \"\"}${i===mov1.length-1 ? \"(Death)\" : \"\"}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Lat Lon:</strong></td>\r\n                  <td>${mov1[i][0].toFixed(3)} ${mov1[i][1].toFixed(3)}</td>\r\n                </tr>  \r\n                <tr>\r\n                  <td><strong>AF Number:</strong></td>\r\n                  <td>${movData[1-1]}</td> \r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Clade:</strong></td>\r\n                  <td>${movData[2-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Slaughter Date:</strong></td>\r\n                  <td>${movData[5-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>CPH:</strong></td>\r\n                  <td>${movData[6-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>CPH Type:</strong></td>\r\n                  <td>${movData[7-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>County:</strong></td>\r\n                  <td>${movData[8-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Risk Area:</strong></td>\r\n                  <td>${movData[9-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>CPH Home Range:</strong></td>\r\n                  <td>${movData[10-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Out of Home Range:</strong></td>\r\n                  <td>${movData[11-1]}</td>\r\n                </tr>\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n          <div class=\"tab-pane fade show\" id=\"navInfoContent\" role=\"tabpanel\" aria-labelledby=\"navInfo\" tabindex=\"0\">\r\n            <table class=\"table table-striped\">\r\n              <tbody>\r\n                <tr>\r\n                  <td><strong>Host:</strong></td>\r\n                  <td>${movData[4-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Breed:</strong></td>\r\n                  <td>${movData[12-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Date of Birth:</strong></td>\r\n                  <td>${movData[13-1]}</td>\r\n                </tr>\r\n                <tr>\r\n                  <td><strong>Sex:</strong></td>\r\n                  <td>${movData[14-1]}</td>\r\n                </tr> \r\n              </tbody>\r\n            </table>\r\n            <img src=\"../images/peter-lloyd-qeABAF-3bEs-unsplash-min.jpg\" alt=\"A photo of a cow\" width=\"100%\">\r\n          </div>\r\n        </div>           \r\n      `;\r\n      \r\n      // Add points to map as a layer\r\n      map.addLayer(cowMarker);\r\n\r\n      // Add popup to points\r\n      cowMarker.bindPopup(popupContent, customOptions);\r\n    };\r\n\r\n    // Connect the points with a blue line\r\n    const linePts = mov1.map(x => x.slice(0,2)); // extract lat and lon and store in a new array\r\n    cattleMovLine = L.polyline(linePts, {color: \"#0096FF\"}).addTo(map); // create polyline object and plot on map\r\n\r\n    // Add arrows to the line\r\n    // Leaflet plugin: https://github.com/slutske22/leaflet-arrowheads\r\n    cattleMovLine.arrowheads({\r\n      yawn: 40,\r\n      size: \"5%\",\r\n      fill: true,\r\n      fillColor: \"#0096FF\",\r\n      // color: \"black\",\r\n      frequency: \"20000m\", // options: 10, \"500m\", \"50px\", \"allvertices\", \"endonly\"\r\n    }).addTo(map);\r\n\r\n    // Zoom in to the bounds of all markers and allow some padding (buffer) to ensure all points are in view\r\n    const bounds = L.latLngBounds(linePts).pad(0.10);\r\n    map.fitBounds(bounds);\r\n\r\n    // Allow access to filters by removing the disabled class from the checkbox\r\n    document.getElementById(\"box_movement-lines\").disabled = false;\r\n\r\n}, {once : true}) // once: true means function is only executed once (on first click)\r\n\r\n\r\n\r\n// ------------------------ //\r\n//\r\n// TOGGLE FILTER LAYERS\r\n//\r\n// ------------------------ //\r\n\r\n// Toggle lines and arrows from map when 'Movement Lines' checkbox ticked or unticked\r\nconst boxMovementLines = document.getElementById(\"box_movement-lines\");\r\nboxMovementLines.addEventListener(\"change\", function(){\r\n\r\n  // When checkbox is ticked, add layer to map\r\n  if(this.checked === true) cattleMovLine.addTo(map);\r\n\r\n  // When checkbox is unticked, remove layer from map\r\n  if(this.checked === false) cattleMovLine.remove();\r\n});\r\n\r\n// TODO Reset View\r\n\r\n\r\n\r\n\r\n\r\n"],"names":[],"version":3,"file":"index.ff16d72e.js.map","sourceRoot":"/__parcel_source_root/"}